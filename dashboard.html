<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StellarRec™ - Letter of Recommendation Platform</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="shortcut icon" href="favicon.ico">
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Roboto', sans-serif; background: #f8f9fa; color: #333; }
        
        .sidebar {
            position: fixed; left: 0; top: 0; width: 280px; height: 100vh;
            background: linear-gradient(135deg, #1976d2 0%, #7c4dff 100%);
            color: white; z-index: 1000; overflow-y: auto;
        }
        
        .sidebar-header { padding: 2rem 1.5rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .logo { display: flex; align-items: center; gap: 0.5rem; font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; }
        .user-info { display: flex; align-items: center; gap: 1rem; }
        .user-avatar { width: 50px; height: 50px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        
        .nav-menu { padding: 1rem 0; }
        .nav-item { display: flex; align-items: center; gap: 1rem; padding: 1rem 1.5rem; color: rgba(255, 255, 255, 0.8); text-decoration: none; transition: all 0.3s ease; border-left: 3px solid transparent; }
        .nav-item:hover, .nav-item.active { background: rgba(255, 255, 255, 0.1); color: white; border-left-color: #ffeb3b; }
        
        .main-content { margin-left: 280px; min-height: 100vh; }
        .top-bar { background: white; padding: 1rem 2rem; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); display: flex; justify-content: space-between; align-items: center; }
        .page-title { font-size: 1.5rem; font-weight: 600; color: #333; }
        
        .user-type-toggle { display: flex; background: #f0f0f0; border-radius: 25px; padding: 0.25rem; }
        .toggle-btn { padding: 0.5rem 1rem; border: none; background: transparent; border-radius: 20px; cursor: pointer; transition: all 0.3s ease; font-weight: 500; }
        .toggle-btn.active { background: #1976d2; color: white; }
        
        .content-area { padding: 2rem; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .dashboard-card { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); transition: all 0.3s ease; }
        .dashboard-card:hover { transform: translateY(-4px); box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12); }
        
        .card-header { display: flex; align-items: center; margin-bottom: 1rem; }
        .card-icon { width: 50px; height: 50px; border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; margin-right: 1rem; }
        .card-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem; }
        .card-subtitle { color: #666; font-size: 0.9rem; }
        
        .progress-bar { width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; margin: 1rem 0; }
        .progress-fill { height: 100%; border-radius: 4px; transition: width 0.3s ease; }
        
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem; }
        .btn-primary { background: #1976d2; color: white; }
        .btn-primary:hover { background: #1565c0; transform: translateY(-2px); }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
        .stat-card { background: white; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); }
        .stat-number { font-size: 2rem; font-weight: 700; color: #1976d2; margin-bottom: 0.5rem; }
        .stat-label { color: #666; font-size: 0.9rem; }
        
        .dashboard-section { display: none; }
        .dashboard-section.active { display: block; }
        
        /* University Directory Styles */
        .university-search { margin-bottom: 2rem; }
        .search-filters { display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .filter-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .filter-group label { font-weight: 500; color: #333; font-size: 0.9rem; }
        .filter-select, .search-input { padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; font-family: inherit; transition: border-color 0.3s ease; }
        .filter-select:focus, .search-input:focus { outline: none; border-color: #1976d2; }
        .search-input { min-width: 300px; }
        
        .university-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; max-height: 600px; overflow-y: auto; padding-right: 1rem; }
        .university-card { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); transition: all 0.3s ease; border: 2px solid transparent; cursor: pointer; }
        .university-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12); border-color: #1976d2; }
        .university-card.selected { border-color: #1976d2; background: #f3f8ff; }
        
        .university-header { display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem; }
        .university-logo { width: 60px; height: 60px; background: #f0f0f0; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: #1976d2; flex-shrink: 0; }
        .university-info h3 { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.25rem; color: #333; }
        .university-location { color: #666; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .university-type { background: #e3f2fd; color: #1976d2; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem; font-weight: 500; }
        
        .university-stats { display: flex; gap: 1rem; margin-top: 1rem; }
        .stat { text-align: center; }
        .stat-value { font-weight: 600; color: #1976d2; font-size: 0.9rem; }
        .stat-label { color: #666; font-size: 0.8rem; }
        
        .selected-universities { margin-top: 2rem; padding: 1.5rem; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); }
        .selected-count { color: #1976d2; font-weight: 600; margin-bottom: 1rem; }
        .selected-list { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .selected-tag { background: #1976d2; color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem; }
        .remove-tag { cursor: pointer; background: rgba(255, 255, 255, 0.2); border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }
        .remove-tag:hover { background: rgba(255, 255, 255, 0.3); }
        
        /* Additional StellarRec Styles */
        .notification-bell { position: relative; cursor: pointer; padding: 0.5rem; }
        .notification-badge { 
            position: absolute; top: 0; right: 0; background: #f44336; color: white; 
            border-radius: 50%; width: 20px; height: 20px; font-size: 0.8rem; 
            display: flex; align-items: center; justify-content: center; 
        }
        
        .top-bar-actions { display: flex; align-items: center; gap: 1rem; }
        
        .section-header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 2rem; 
        }
        .section-description { color: #666; font-size: 0.9rem; margin: 0; }
        
        /* Letter Management Styles */
        .letter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem; }
        .letter-card { 
            background: white; border-radius: 12px; padding: 1.5rem; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); 
        }
        .letter-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .letter-info h3 { font-size: 1.2rem; margin-bottom: 0.5rem; }
        .letter-student { color: #1976d2; font-weight: 500; margin-bottom: 0.25rem; }
        .letter-meta { color: #666; font-size: 0.9rem; }
        
        .status-badge { 
            padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem; font-weight: 500; 
        }
        .status-badge.active { background: #e8f5e8; color: #4caf50; }
        .status-badge.pending { background: #fff3e0; color: #ff9800; }
        .status-badge.delivered { background: #e3f2fd; color: #1976d2; }
        .status-badge.approved { background: #e8f5e8; color: #4caf50; }
        .status-badge.in-transit { background: #fff3e0; color: #ff9800; }
        
        .letter-stats { 
            display: flex; gap: 2rem; margin: 1rem 0; padding: 1rem 0; 
            border-top: 1px solid #e0e0e0; border-bottom: 1px solid #e0e0e0; 
        }
        .stat-item { text-align: center; }
        .stat-value { display: block; font-size: 1.5rem; font-weight: 600; color: #1976d2; }
        .stat-label { font-size: 0.8rem; color: #666; }
        
        .letter-actions { display: flex; gap: 0.5rem; margin-top: 1rem; }
        
        /* Delivery Tracking Styles */
        .tracking-filters { display: flex; gap: 1rem; }
        .delivery-table { background: white; border-radius: 12px; overflow: hidden; }
        .table-header, .table-row { 
            display: grid; 
            grid-template-columns: 1fr 1.5fr 1fr 1fr 1.2fr 0.8fr; 
            gap: 1rem; padding: 1rem; align-items: center; 
        }
        .table-header { 
            background: #f5f5f5; font-weight: 600; color: #333; 
            border-bottom: 1px solid #e0e0e0; 
        }
        .table-row { border-bottom: 1px solid #f0f0f0; }
        .table-row:hover { background: #f9f9f9; }
        
        .method-badge { 
            padding: 0.25rem 0.5rem; border-radius: 10px; font-size: 0.8rem; font-weight: 500; 
        }
        .method-badge.api { background: #e8f5e8; color: #4caf50; }
        .method-badge.secure-inbox { background: #e3f2fd; color: #1976d2; }
        .method-badge.email { background: #fff3e0; color: #ff9800; }
        
        .btn-icon { 
            background: none; border: none; cursor: pointer; padding: 0.5rem; 
            border-radius: 50%; transition: background 0.3s ease; 
        }
        .btn-icon:hover { background: #f0f0f0; }
        
        /* Consent Management Styles */
        .consent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 1.5rem; }
        .consent-card { 
            background: white; border-radius: 12px; padding: 1.5rem; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); 
        }
        .consent-card.pending { border-left: 4px solid #ff9800; }
        .consent-card.approved { border-left: 4px solid #4caf50; }
        
        .consent-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .student-info h3 { margin-bottom: 0.25rem; }
        .student-info p { color: #666; font-size: 0.9rem; }
        
        .consent-request, .consent-details { 
            background: #f9f9f9; padding: 1rem; border-radius: 8px; margin: 1rem 0; 
        }
        .consent-request p, .consent-details p { margin-bottom: 0.5rem; }
        .consent-request p:last-child, .consent-details p:last-child { margin-bottom: 0; }
        
        .consent-actions { display: flex; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap; }
        .btn-approve { 
            background: #4caf50; color: white; border: none; padding: 0.5rem 1rem; 
            border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; 
        }
        .btn-decline { 
            background: #f44336; color: white; border: none; padding: 0.5rem 1rem; 
            border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; 
        }
        
        /* Delivery List Styles */
        .delivery-list { margin: 1rem 0; }
        .delivery-item { 
            display: flex; align-items: center; gap: 1rem; padding: 0.75rem 0; 
            border-bottom: 1px solid #f0f0f0; 
        }
        .delivery-item:last-child { border-bottom: none; }
        .delivery-status.delivered { color: #4caf50; font-weight: bold; }
        .delivery-time { margin-left: auto; color: #666; font-size: 0.9rem; }
        
        /* Approval List Styles */
        .approval-list { margin: 1rem 0; }
        .approval-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 1rem; background: #f9f9f9; border-radius: 8px; margin-bottom: 0.5rem; 
        }
        .approval-details { color: #666; font-size: 0.9rem; margin-top: 0.25rem; }
        .approval-actions { display: flex; gap: 0.5rem; }
        .approval-actions .btn-approve, .approval-actions .btn-decline { 
            width: 35px; height: 35px; border-radius: 50%; display: flex; 
            align-items: center; justify-content: center; font-size: 1.2rem; 
        }
        
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s ease; }
            .main-content { margin-left: 0; }
            .content-area { padding: 1rem; }
            .dashboard-grid { grid-template-columns: 1fr; }
            .letter-grid { grid-template-columns: 1fr; }
            .consent-grid { grid-template-columns: 1fr; }
            .table-header, .table-row { grid-template-columns: 1fr; }
            .tracking-filters { flex-direction: column; }
            .top-bar-actions { flex-direction: column; gap: 0.5rem; }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <a href="index.html" class="logo" style="text-decoration: none; color: inherit; cursor: pointer;">
                <span class="material-icons">star</span>
                stellarrec
            </a>
            <div class="user-info">
                <div class="user-avatar">
                    <span class="material-icons" id="userIcon">person</span>
                </div>
                <div class="user-details">
                    <h3 id="userName">Dr. Sarah Chen</h3>
                    <p id="userRole">Recommender</p>
                    <p id="userAffiliation" style="font-size: 0.8rem; opacity: 0.8;">MIT Computer Science</p>
                </div>
            </div>
        </div>
        
        <nav class="nav-menu" id="navMenu">
            <!-- Navigation will be populated based on user role -->
        </nav>
    </div>

    <div class="main-content">
        <div class="top-bar">
            <h1 class="page-title" id="pageTitle">Letter Management Dashboard</h1>
            <div class="top-bar-actions">
                <div class="user-type-toggle">
                    <button class="toggle-btn" onclick="switchUserType('student')">Student View</button>
                    <button class="toggle-btn active" onclick="switchUserType('recommender')">Recommender View</button>
                    <button class="toggle-btn" onclick="switchUserType('institution')">Institution View</button>
                    <button class="toggle-btn" onclick="switchUserType('admin')">Admin View</button>
                </div>
                <div class="notification-bell">
                    <span class="material-icons">notifications</span>
                    <span class="notification-badge" id="notificationCount">3</span>
                </div>
            </div>
        </div>

        <div class="content-area">
            <!-- RECOMMENDER DASHBOARD -->
            <div class="dashboard-section active" id="recommender-overview">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">8</div>
                        <div class="stat-label">Active Letters</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">24</div>
                        <div class="stat-label">Total Deliveries</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3</div>
                        <div class="stat-label">Pending Approvals</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">96%</div>
                        <div class="stat-label">Delivery Success Rate</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #4caf50, #66bb6a);">
                                <span class="material-icons">assignment_turned_in</span>
                            </div>
                            <div>
                                <div class="card-title">Recent Deliveries</div>
                                <div class="card-subtitle">5 letters delivered today</div>
                            </div>
                        </div>
                        <div class="delivery-list">
                            <div class="delivery-item">
                                <span class="delivery-status delivered">✓</span>
                                <span>MIT - Alex Chen - STEM Grad 2025</span>
                                <span class="delivery-time">2 hours ago</span>
                            </div>
                            <div class="delivery-item">
                                <span class="delivery-status delivered">✓</span>
                                <span>Stanford - Maria Rodriguez - CS PhD</span>
                                <span class="delivery-time">4 hours ago</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('delivery-tracking')">View All Deliveries</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #ff9800, #ffb74d);">
                                <span class="material-icons">pending_actions</span>
                            </div>
                            <div>
                                <div class="card-title">Pending Approvals</div>
                                <div class="card-subtitle">3 new destination requests</div>
                            </div>
                        </div>
                        <div class="approval-list">
                            <div class="approval-item">
                                <div class="approval-info">
                                    <strong>David Kim</strong> wants to add <strong>CMU</strong>
                                    <div class="approval-details">STEM Grad 2025 • Expires in 2 days</div>
                                </div>
                                <div class="approval-actions">
                                    <button class="btn-approve">✓</button>
                                    <button class="btn-decline">✗</button>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('consent-management')">Manage All Approvals</button>
                    </div>
                </div>
            </div>

            <!-- LETTER MANAGEMENT SECTION -->
            <div class="dashboard-section" id="letter-management">
                <div class="section-header">
                    <h2>Letter Management</h2>
                    <button class="btn btn-primary" onclick="showLetterUpload()">
                        <span class="material-icons">add</span>
                        Create New Letter
                    </button>
                </div>

                <div class="letter-grid">
                    <div class="letter-card">
                        <div class="letter-header">
                            <div class="letter-info">
                                <h3>STEM Graduate Programs 2025</h3>
                                <p class="letter-student">For: Alex Chen, Maria Rodriguez, David Kim</p>
                                <p class="letter-meta">Created: Jan 15, 2025 • Last updated: Jan 20, 2025</p>
                            </div>
                            <div class="letter-status">
                                <span class="status-badge active">Active</span>
                            </div>
                        </div>
                        
                        <div class="letter-stats">
                            <div class="stat-item">
                                <span class="stat-value">12</span>
                                <span class="stat-label">Deliveries</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">3</span>
                                <span class="stat-label">Students</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">8</span>
                                <span class="stat-label">Universities</span>
                            </div>
                        </div>

                        <div class="letter-actions">
                            <button class="btn btn-outline" onclick="viewLetter('stem-2025')">View Letter</button>
                            <button class="btn btn-outline" onclick="editLetter('stem-2025')">Edit</button>
                            <button class="btn btn-outline" onclick="viewDeliveries('stem-2025')">Track Deliveries</button>
                        </div>
                    </div>

                    <div class="letter-card">
                        <div class="letter-header">
                            <div class="letter-info">
                                <h3>Business School Applications 2025</h3>
                                <p class="letter-student">For: Sarah Johnson</p>
                                <p class="letter-meta">Created: Dec 10, 2024 • Last updated: Jan 18, 2025</p>
                            </div>
                            <div class="letter-status">
                                <span class="status-badge active">Active</span>
                            </div>
                        </div>
                        
                        <div class="letter-stats">
                            <div class="stat-item">
                                <span class="stat-value">6</span>
                                <span class="stat-label">Deliveries</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">1</span>
                                <span class="stat-label">Students</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">6</span>
                                <span class="stat-label">Universities</span>
                            </div>
                        </div>

                        <div class="letter-actions">
                            <button class="btn btn-outline" onclick="viewLetter('business-2025')">View Letter</button>
                            <button class="btn btn-outline" onclick="editLetter('business-2025')">Edit</button>
                            <button class="btn btn-outline" onclick="viewDeliveries('business-2025')">Track Deliveries</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DELIVERY TRACKING SECTION -->
            <div class="dashboard-section" id="delivery-tracking">
                <div class="section-header">
                    <h2>Delivery Tracking</h2>
                    <div class="tracking-filters">
                        <select class="filter-select">
                            <option>All Letters</option>
                            <option>STEM Graduate 2025</option>
                            <option>Business School 2025</option>
                        </select>
                        <select class="filter-select">
                            <option>All Statuses</option>
                            <option>Delivered</option>
                            <option>In Transit</option>
                            <option>Failed</option>
                        </select>
                    </div>
                </div>

                <div class="delivery-table">
                    <div class="table-header">
                        <div class="col-student">Student</div>
                        <div class="col-university">University</div>
                        <div class="col-method">Delivery Method</div>
                        <div class="col-status">Status</div>
                        <div class="col-timestamp">Timestamp</div>
                        <div class="col-actions">Actions</div>
                    </div>
                    
                    <div class="table-row">
                        <div class="col-student">Alex Chen</div>
                        <div class="col-university">MIT EECS</div>
                        <div class="col-method">
                            <span class="method-badge api">Native API</span>
                        </div>
                        <div class="col-status">
                            <span class="status-badge delivered">Delivered</span>
                        </div>
                        <div class="col-timestamp">Jan 22, 2025 2:30 PM</div>
                        <div class="col-actions">
                            <button class="btn-icon" onclick="viewDeliveryDetails('del-001')">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>

                    <div class="table-row">
                        <div class="col-student">Maria Rodriguez</div>
                        <div class="col-university">Stanford CS</div>
                        <div class="col-method">
                            <span class="method-badge secure-inbox">Secure Inbox</span>
                        </div>
                        <div class="col-status">
                            <span class="status-badge delivered">Delivered</span>
                        </div>
                        <div class="col-timestamp">Jan 22, 2025 1:15 PM</div>
                        <div class="col-actions">
                            <button class="btn-icon" onclick="viewDeliveryDetails('del-002')">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>

                    <div class="table-row">
                        <div class="col-student">David Kim</div>
                        <div class="col-university">CMU SCS</div>
                        <div class="col-method">
                            <span class="method-badge email">Secure Email</span>
                        </div>
                        <div class="col-status">
                            <span class="status-badge in-transit">In Transit</span>
                        </div>
                        <div class="col-timestamp">Jan 22, 2025 3:45 PM</div>
                        <div class="col-actions">
                            <button class="btn-icon" onclick="retryDelivery('del-003')">
                                <span class="material-icons">refresh</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONSENT MANAGEMENT SECTION -->
            <div class="dashboard-section" id="consent-management">
                <div class="section-header">
                    <h2>Consent & Approval Management</h2>
                    <p class="section-description">Manage student requests and destination approvals</p>
                </div>

                <div class="consent-grid">
                    <div class="consent-card pending">
                        <div class="consent-header">
                            <div class="student-info">
                                <h3>David Kim</h3>
                                <p>STEM Graduate Programs 2025</p>
                            </div>
                            <div class="consent-status">
                                <span class="status-badge pending">Pending Approval</span>
                            </div>
                        </div>
                        
                        <div class="consent-request">
                            <p><strong>New Destination Request:</strong> Carnegie Mellon University - School of Computer Science</p>
                            <p><strong>Program Type:</strong> PhD Computer Science</p>
                            <p><strong>Delivery Method:</strong> Secure Email (FERPA Compliant)</p>
                            <p><strong>Student Visibility:</strong> Status only (sealed letter)</p>
                        </div>

                        <div class="consent-actions">
                            <button class="btn btn-approve" onclick="approveDestination('req-001')">
                                <span class="material-icons">check</span>
                                Approve
                            </button>
                            <button class="btn btn-decline" onclick="declineDestination('req-001')">
                                <span class="material-icons">close</span>
                                Decline
                            </button>
                            <button class="btn btn-outline" onclick="viewConsentDetails('req-001')">
                                View Details
                            </button>
                        </div>
                    </div>

                    <div class="consent-card approved">
                        <div class="consent-header">
                            <div class="student-info">
                                <h3>Alex Chen</h3>
                                <p>STEM Graduate Programs 2025</p>
                            </div>
                            <div class="consent-status">
                                <span class="status-badge approved">Approved</span>
                            </div>
                        </div>
                        
                        <div class="consent-details">
                            <p><strong>Approved Destinations:</strong> MIT, Stanford, Berkeley, Caltech</p>
                            <p><strong>Reuse Policy:</strong> Allowed for STEM programs until Dec 2025</p>
                            <p><strong>Student Visibility:</strong> Full access granted</p>
                            <p><strong>Last Updated:</strong> Jan 15, 2025</p>
                        </div>

                        <div class="consent-actions">
                            <button class="btn btn-outline" onclick="editConsent('consent-001')">
                                Edit Permissions
                            </button>
                            <button class="btn btn-outline" onclick="viewConsentLog('consent-001')">
                                View Audit Log
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STUDENT DASHBOARD -->
            <div class="dashboard-section" id="student-overview">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">5</div>
                        <div class="stat-label">Active Requests</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Letters Sent</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">8</div>
                        <div class="stat-label">Universities Applied</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3</div>
                        <div class="stat-label">Pending Approvals</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #1976d2, #42a5f5);">
                                <span class="material-icons">mail</span>
                            </div>
                            <div>
                                <div class="card-title">Recommendation Requests</div>
                                <div class="card-subtitle">5 active requests</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('student-requests')">Manage Requests</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #4caf50, #66bb6a);">
                                <span class="material-icons">track_changes</span>
                            </div>
                            <div>
                                <div class="card-title">Application Tracking</div>
                                <div class="card-subtitle">Real-time delivery status</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('student-tracking')">Track Applications</button>
                    </div>
                </div>
            </div>

            <!-- INSTITUTION DASHBOARD -->
            <div class="dashboard-section" id="institution-overview">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">156</div>
                        <div class="stat-label">Letters Received Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">2,847</div>
                        <div class="stat-label">Total This Cycle</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">98.5%</div>
                        <div class="stat-label">API Uptime</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">45</div>
                        <div class="stat-label">Active Programs</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #ff9800, #ffb74d);">
                                <span class="material-icons">inbox</span>
                            </div>
                            <div>
                                <div class="card-title">Letter Inbox</div>
                                <div class="card-subtitle">156 new letters today</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('institution-inbox')">View Inbox</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #7c4dff, #9c27b0);">
                                <span class="material-icons">settings</span>
                            </div>
                            <div>
                                <div class="card-title">Integration Settings</div>
                                <div class="card-subtitle">API & delivery configuration</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('institution-settings')">Configure</button>
                    </div>
                </div>
            </div>

            <!-- ADMIN DASHBOARD -->
            <div class="dashboard-section" id="admin-overview">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">12,456</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3,892</div>
                        <div class="stat-label">Active Letters</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">847</div>
                        <div class="stat-label">Partner Institutions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">99.2%</div>
                        <div class="stat-label">System Uptime</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #f44336, #ef5350);">
                                <span class="material-icons">security</span>
                            </div>
                            <div>
                                <div class="card-title">Trust & Safety</div>
                                <div class="card-subtitle">5 flagged accounts</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('admin-security')">Review Flags</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #607d8b, #78909c);">
                                <span class="material-icons">analytics</span>
                            </div>
                            <div>
                                <div class="card-title">System Analytics</div>
                                <div class="card-subtitle">Performance & usage metrics</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showSection('admin-analytics')">View Analytics</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // StellarRec™ Dashboard System
        let currentUserType = 'recommender';
        let currentSection = 'recommender-overview';
        
        // User data simulation
        const userData = {
            recommender: {
                name: "Dr. Sarah Chen",
                role: "Recommender",
                affiliation: "MIT Computer Science",
                icon: "school",
                stats: { activeLetters: 8, totalDeliveries: 24, pendingApprovals: 3, successRate: "96%" }
            },
            student: {
                name: "Alex Johnson",
                role: "Student",
                affiliation: "Senior, Computer Science",
                icon: "person",
                stats: { activeRequests: 5, lettersSent: 12, universitiesApplied: 8, pendingApprovals: 3 }
            },
            institution: {
                name: "MIT Admissions",
                role: "Institution",
                affiliation: "Graduate Admissions Office",
                icon: "business",
                stats: { lettersToday: 156, totalCycle: 2847, apiUptime: "98.5%", activePrograms: 45 }
            },
            admin: {
                name: "System Admin",
                role: "Administrator",
                affiliation: "StellarRec Platform",
                icon: "admin_panel_settings",
                stats: { totalUsers: 12456, activeLetters: 3892, partnerInstitutions: 847, systemUptime: "99.2%" }
            }
        };

        // Navigation menus for different user types
        const navigationMenus = {
            recommender: [
                { id: 'recommender-overview', icon: 'dashboard', label: 'Overview' },
                { id: 'letter-management', icon: 'mail', label: 'Letter Management' },
                { id: 'delivery-tracking', icon: 'track_changes', label: 'Delivery Tracking' },
                { id: 'consent-management', icon: 'verified_user', label: 'Consent Management' },
                { id: 'notifications', icon: 'notifications', label: 'Notifications' }
            ],
            student: [
                { id: 'student-overview', icon: 'dashboard', label: 'Overview' },
                { id: 'student-requests', icon: 'mail_outline', label: 'My Requests' },
                { id: 'student-tracking', icon: 'track_changes', label: 'Application Tracking' },
                { id: 'university-search', icon: 'school', label: 'Find Universities' }
            ],
            institution: [
                { id: 'institution-overview', icon: 'dashboard', label: 'Overview' },
                { id: 'institution-inbox', icon: 'inbox', label: 'Letter Inbox' },
                { id: 'institution-settings', icon: 'settings', label: 'Integration Settings' },
                { id: 'institution-analytics', icon: 'analytics', label: 'Analytics' }
            ],
            admin: [
                { id: 'admin-overview', icon: 'dashboard', label: 'Overview' },
                { id: 'admin-security', icon: 'security', label: 'Trust & Safety' },
                { id: 'admin-analytics', icon: 'analytics', label: 'System Analytics' },
                { id: 'admin-users', icon: 'people', label: 'User Management' },
                { id: 'admin-institutions', icon: 'business', label: 'Institution Partners' }
            ]
        };

        // Initialize dashboard
        function initializeDashboard() {
            updateUserInterface();
            updateNavigation();
            updateStats();
            showSection(currentSection);
        }

        // Switch user type
        function switchUserType(userType) {
            currentUserType = userType;
            
            // Update active toggle button
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update section based on user type
            currentSection = userType + '-overview';
            
            updateUserInterface();
            updateNavigation();
            updateStats();
            showSection(currentSection);
        }

        // Update user interface elements
        function updateUserInterface() {
            const user = userData[currentUserType];
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userRole').textContent = user.role;
            document.getElementById('userAffiliation').textContent = user.affiliation;
            document.getElementById('userIcon').textContent = user.icon;
            
            // Update page title
            const titles = {
                recommender: 'Letter Management Dashboard',
                student: 'Application Tracking Dashboard',
                institution: 'Letter Intake Dashboard',
                admin: 'System Administration Dashboard'
            };
            document.getElementById('pageTitle').textContent = titles[currentUserType];
        }

        // Update navigation menu
        function updateNavigation() {
            const navMenu = document.getElementById('navMenu');
            const menu = navigationMenus[currentUserType];
            
            navMenu.innerHTML = menu.map(item => `
                <a href="#" class="nav-item ${item.id === currentSection ? 'active' : ''}" 
                   onclick="showSection('${item.id}')">
                    <span class="material-icons">${item.icon}</span>
                    ${item.label}
                </a>
            `).join('');
        }

        // Update statistics
        function updateStats() {
            const stats = userData[currentUserType].stats;
            const statCards = document.querySelectorAll('.stat-number');
            const statValues = Object.values(stats);
            
            statCards.forEach((card, index) => {
                if (statValues[index]) {
                    card.textContent = statValues[index];
                }
            });
        }

        // Show specific section
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                currentSection = sectionId;
            }
            
            // Update navigation active state
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeNavItem = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
            }
        }

        // Letter management functions
        function showLetterUpload() {
            alert('Letter upload modal would open here. Features:\n\n• Paste text, upload DOC/PDF, or connect Google Docs\n• Set reuse policy and visibility rules\n• Define expiry date\n• Add e-signature integration');
        }

        function viewLetter(letterId) {
            alert(`Viewing letter: ${letterId}\n\nThis would show:\n• Full letter content\n• Metadata and version history\n• Current consent settings\n• Delivery history`);
        }

        function editLetter(letterId) {
            alert(`Editing letter: ${letterId}\n\nFeatures:\n• Version control with audit trail\n• Student notification of changes\n• Re-delivery options\n• Lock letter for cycle option`);
        }

        function viewDeliveries(letterId) {
            showSection('delivery-tracking');
        }

        // Delivery tracking functions
        function viewDeliveryDetails(deliveryId) {
            alert(`Delivery Details: ${deliveryId}\n\n• Delivery method: Native API\n• Status: Successfully delivered\n• Receipt ID: MIT-2025-001847\n• Timestamp: Jan 22, 2025 2:30 PM\n• Checksum verified: ✓`);
        }

        function retryDelivery(deliveryId) {
            alert(`Retrying delivery: ${deliveryId}\n\nSystem will:\n• Check consent scope\n• Apply fallback delivery method\n• Generate new secure link\n• Send notification to student`);
        }

        // Consent management functions
        function approveDestination(requestId) {
            alert(`Approving destination request: ${requestId}\n\n✓ CMU added to approved destinations\n✓ Student notified\n✓ Letter queued for delivery\n✓ Audit log updated`);
        }

        function declineDestination(requestId) {
            alert(`Declining destination request: ${requestId}\n\n✗ Request declined\n✗ Student notified with reason\n✓ Audit log updated`);
        }

        function viewConsentDetails(requestId) {
            alert(`Consent Details: ${requestId}\n\n• Student: David Kim\n• Program: PhD Computer Science\n• Institution: Carnegie Mellon University\n• Delivery: Secure Email (FERPA)\n• Visibility: Status only (sealed)\n• Expiry: Dec 31, 2025`);
        }

        function editConsent(consentId) {
            alert(`Editing consent: ${consentId}\n\nModifiable settings:\n• Destination list\n• Reuse policy\n• Student visibility\n• Expiry date\n• Delivery preferences`);
        }

        function viewConsentLog(consentId) {
            alert(`Consent Audit Log: ${consentId}\n\n• Jan 15, 2025 - Initial consent granted\n• Jan 18, 2025 - MIT added to destinations\n• Jan 20, 2025 - Stanford added\n• Jan 22, 2025 - Berkeley added\n\nAll changes logged with timestamps and actor IDs`);
        }

        // Notification system
        function updateNotificationCount() {
            const counts = {
                recommender: 3,
                student: 2,
                institution: 8,
                admin: 12
            };
            document.getElementById('notificationCount').textContent = counts[currentUserType];
        }

        // Simulated real-time updates
        function simulateRealTimeUpdates() {
            setInterval(() => {
                // Simulate delivery status updates
                const deliveryItems = document.querySelectorAll('.delivery-item');
                if (deliveryItems.length > 0 && Math.random() > 0.8) {
                    // Randomly update a delivery status
                    console.log('Real-time delivery update received');
                }
                
                // Update notification count occasionally
                if (Math.random() > 0.9) {
                    updateNotificationCount();
                }
            }, 5000);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            simulateRealTimeUpdates();
        });
    </script>
</body>
</html>ame: "New York University", location: "New York, NY", state: "NY", type: "Private", size: "Large", acceptance: "12%", ranking: 66 },
            { name: "University of Rochester", location: "Rochester, NY", state: "NY", type: "Private", size: "Large", acceptance: "30%", ranking: 67 },
            { name: "Syracuse University", location: "Syracuse, NY", state: "NY", type: "Private", size: "Large", acceptance: "44%", ranking: 68 },
            { name: "Fordham University", location: "Bronx, NY", state: "NY", type: "Private", size: "Large", acceptance: "46%", ranking: 69 },
            { name: "SUNY Binghamton", location: "Binghamton, NY", state: "NY", type: "Public", size: "Large", acceptance: "40%", ranking: 70 },
            
            // Texas
            { name: "Rice University", location: "Houston, TX", state: "TX", type: "Private", size: "Medium", acceptance: "9%", ranking: 71 },
            { name: "Texas A&M University", location: "College Station, TX", state: "TX", type: "Public", size: "Large", acceptance: "58%", ranking: 72 },
            { name: "Baylor University", location: "Waco, TX", state: "TX", type: "Private", size: "Large", acceptance: "45%", ranking: 73 },
            { name: "Southern Methodist University", location: "Dallas, TX", state: "TX", type: "Private", size: "Large", acceptance: "47%", ranking: 74 },
            { name: "Texas Christian University", location: "Fort Worth, TX", state: "TX", type: "Private", size: "Large", acceptance: "40%", ranking: 75 },
            
            // Florida
            { name: "Florida State University", location: "Tallahassee, FL", state: "FL", type: "Public", size: "Large", acceptance: "32%", ranking: 76 },
            { name: "University of Miami", location: "Coral Gables, FL", state: "FL", type: "Private", size: "Large", acceptance: "27%", ranking: 77 },
            { name: "Florida Institute of Technology", location: "Melbourne, FL", state: "FL", type: "Private", size: "Medium", acceptance: "54%", ranking: 78 },
            
            // More states and universities...
            { name: "Arizona State University", location: "Tempe, AZ", state: "AZ", type: "Public", size: "Large", acceptance: "88%", ranking: 80 },
            { name: "University of Arizona", location: "Tucson, AZ", state: "AZ", type: "Public", size: "Large", acceptance: "87%", ranking: 81 },
            { name: "University of Colorado Boulder", location: "Boulder, CO", state: "CO", type: "Public", size: "Large", acceptance: "78%", ranking: 82 },
            { name: "Colorado State University", location: "Fort Collins, CO", state: "CO", type: "Public", size: "Large", acceptance: "91%", ranking: 83 },
            { name: "University of Oregon", location: "Eugene, OR", state: "OR", type: "Public", size: "Large", acceptance: "83%", ranking: 84 },
            { name: "Oregon State University", location: "Corvallis, OR", state: "OR", type: "Public", size: "Large", acceptance: "82%", ranking: 85 }
        ];

        function showSection(sectionName) {
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(sectionName).classList.add('active');
            event.target.classList.add('active');
            
            const titles = {
                'overview': 'Dashboard Overview',
                'universities': 'University Directory',
                'applications': 'Applications',
                'essays': 'Essay Editor'
            };
            
            document.getElementById('pageTitle').textContent = titles[sectionName] || 'Dashboard';
            
            if (sectionName === 'universities') {
                loadUniversities();
            }
        }

        function switchUserType(userType) {
            currentUserType = userType;
            
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (userType === 'student') {
                document.getElementById('userName').textContent = 'Alex Johnson';
                document.getElementById('userType').textContent = 'Student';
            } else {
                document.getElementById('userName').textContent = 'Dr. Sarah Wilson';
                document.getElementById('userType').textContent = 'Recommender';
            }
        }

        function loadUniversities() {
            allUniversities = [...universities];
            displayUniversities(allUniversities);
            setupFilters();
        }

        function displayUniversities(universitiesToShow) {
            const grid = document.getElementById('universityGrid');
            grid.innerHTML = '';
            
            universitiesToShow.forEach(university => {
                const card = document.createElement('div');
                card.className = 'university-card';
                card.onclick = () => toggleUniversitySelection(university);
                
                if (selectedUniversities.some(u => u.name === university.name)) {
                    card.classList.add('selected');
                }
                
                card.innerHTML = `
                    <div class="university-header">
                        <div class="university-logo">
                            <span class="material-icons">school</span>
                        </div>
                        <div class="university-info">
                            <h3>${university.name}</h3>
                            <div class="university-location">${university.location}</div>
                            <span class="university-type">${university.type}</span>
                        </div>
                    </div>
                    <div class="university-stats">
                        <div class="stat">
                            <div class="stat-value">${university.acceptance}</div>
                            <div class="stat-label">Acceptance</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">#${university.ranking}</div>
                            <div class="stat-label">Ranking</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${university.size}</div>
                            <div class="stat-label">Size</div>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        function setupFilters() {
            const searchInput = document.getElementById('universitySearch');
            const stateFilter = document.getElementById('stateFilter');
            const typeFilter = document.getElementById('typeFilter');
            const sizeFilter = document.getElementById('sizeFilter');
            
            [searchInput, stateFilter, typeFilter, sizeFilter].forEach(element => {
                element.addEventListener('change', filterUniversities);
                element.addEventListener('input', filterUniversities);
            });
        }

        function filterUniversities() {
            const searchTerm = document.getElementById('universitySearch').value.toLowerCase();
            const stateFilter = document.getElementById('stateFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const sizeFilter = document.getElementById('sizeFilter').value;
            
            let filtered = allUniversities.filter(university => {
                const matchesSearch = university.name.toLowerCase().includes(searchTerm) || 
                                    university.location.toLowerCase().includes(searchTerm);
                const matchesState = !stateFilter || university.state === stateFilter;
                const matchesType = !typeFilter || university.type === typeFilter;
                const matchesSize = !sizeFilter || university.size === sizeFilter;
                
                return matchesSearch && matchesState && matchesType && matchesSize;
            });
            
            displayUniversities(filtered);
        }

        function toggleUniversitySelection(university) {
            const index = selectedUniversities.findIndex(u => u.name === university.name);
            
            if (index > -1) {
                selectedUniversities.splice(index, 1);
            } else {
                selectedUniversities.push(university);
            }
            
            updateSelectedDisplay();
            displayUniversities(allUniversities.filter(u => 
                document.getElementById('universitySearch').value === '' || 
                u.name.toLowerCase().includes(document.getElementById('universitySearch').value.toLowerCase()) ||
                u.location.toLowerCase().includes(document.getElementById('universitySearch').value.toLowerCase())
            ));
        }

        function updateSelectedDisplay() {
            const selectedDiv = document.getElementById('selectedUniversities');
            const countDiv = document.getElementById('selectedCount');
            const listDiv = document.getElementById('selectedList');
            
            if (selectedUniversities.length > 0) {
                selectedDiv.style.display = 'block';
                countDiv.textContent = `${selectedUniversities.length} universities selected`;
                
                listDiv.innerHTML = selectedUniversities.map(university => `
                    <div class="selected-tag">
                        ${university.name}
                        <span class="remove-tag" onclick="removeUniversity('${university.name}')">×</span>
                    </div>
                `).join('');
            } else {
                selectedDiv.style.display = 'none';
            }
        }

        function removeUniversity(universityName) {
            selectedUniversities = selectedUniversities.filter(u => u.name !== universityName);
            updateSelectedDisplay();
            displayUniversities(allUniversities);
        }

        function proceedWithSelection() {
            if (selectedUniversities.length > 0) {
                alert(`Great! You've selected ${selectedUniversities.length} universities. This would typically proceed to the application process.`);
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadUniversities();
        });
    </script>
</body>
</html>