<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StellarRec - One Upload, Multiple Universities</title>

    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #1976d2 0%, #7c4dff 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 20px rgba(25, 118, 210, 0.3);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
            color: white;
            transition: all 0.3s ease;
        }

        .logo:hover {
            opacity: 0.8;
            transform: translateY(-1px);
        }

        .user-info {
            position: relative;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .user-avatar:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .user-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-header {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: #333;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .dropdown-item:hover {
            background: #f8f9fa;
        }

        .dropdown-item.active {
            background: #e3f2fd;
            color: #1976d2;
        }

        .dropdown-item .material-icons {
            font-size: 1.2rem;
            color: #666;
        }

        .dropdown-item.active .material-icons {
            color: #1976d2;
        }

        .view-label {
            display: flex;
            flex-direction: column;
        }

        .view-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .view-description {
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.1rem;
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            margin-bottom: 3rem;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1976d2;
            margin-bottom: 1rem;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 2rem;
        }

        /* Upload Section */
        .upload-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            border: 2px dashed #e0e0e0;
            transition: all 0.3s ease;
        }

        .upload-section.dragover {
            border-color: #1976d2;
            background: #f3f8ff;
        }

        .upload-area {
            text-align: center;
            padding: 2rem;
        }

        .upload-icon {
            font-size: 4rem;
            color: #1976d2;
            margin-bottom: 1rem;
        }

        .upload-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .upload-subtitle {
            color: #666;
            margin-bottom: 2rem;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #1976d2, #7c4dff);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(25, 118, 210, 0.3);
        }

        /* Uploaded File Display */
        .uploaded-file {
            display: none;
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .file-icon {
            font-size: 2rem;
            color: #4caf50;
        }

        .file-details h3 {
            color: #2e7d32;
            margin-bottom: 0.25rem;
        }

        .file-details p {
            color: #4caf50;
            font-size: 0.9rem;
        }

        .remove-file {
            margin-left: auto;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .remove-file:hover {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
        }

        /* University Selection */
        .university-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .university-search {
            margin-bottom: 2rem;
        }

        .search-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #1976d2;
        }

        .university-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
            border: 1px solid #f0f0f0;
            border-radius: 12px;
        }

        .university-card {
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .university-card:hover {
            border-color: #1976d2;
            background: #f3f8ff;
        }

        .university-card.selected {
            border-color: #1976d2;
            background: #e3f2fd;
        }

        .university-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .university-logo {
            width: 40px;
            height: 40px;
            background: #1976d2;
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .university-name {
            font-weight: 600;
            color: #333;
        }

        .university-location {
            color: #666;
            font-size: 0.9rem;
        }

        /* Selected Universities */
        .selected-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .selected-count {
            color: #1976d2;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .selected-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .selected-tag {
            background: linear-gradient(135deg, #1976d2, #7c4dff);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .remove-tag {
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .remove-tag:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Send Button */
        .send-section {
            text-align: center;
        }

        .send-btn {
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            color: white;
            padding: 1.2rem 3rem;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            disabled: true;
        }

        .send-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .send-btn:not(:disabled):hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
        }

        /* Progress Section */
        .progress-section {
            display: none;
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .progress-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            border-radius: 6px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        .delivery-list {
            margin-top: 1rem;
        }

        .delivery-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            background: #f8f9fa;
        }

        .delivery-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .delivery-status.pending {
            background: #fff3e0;
            color: #ff9800;
        }

        .delivery-status.success {
            background: #e8f5e8;
            color: #4caf50;
        }

        .delivery-status.error {
            background: #ffebee;
            color: #f44336;
        }

        /* Success Section */
        .success-section {
            display: none;
            background: linear-gradient(135deg, #e8f5e8, #f1f8e9);
            border: 2px solid #4caf50;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 8px 32px rgba(76, 175, 80, 0.2);
        }

        .success-icon {
            font-size: 4rem;
            color: #4caf50;
            margin-bottom: 1rem;
        }

        .success-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 1rem;
        }

        .success-subtitle {
            color: #4caf50;
            margin-bottom: 2rem;
        }

        .new-upload-btn {
            background: linear-gradient(135deg, #1976d2, #7c4dff);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .new-upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(25, 118, 210, 0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .hero-title {
                font-size: 2rem;
            }

            .university-grid {
                grid-template-columns: 1fr;
            }

            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <a href="index.html" class="logo">
                <span class="material-icons">star</span>
                stellarrec
            </a>
            <div class="user-info">
                <div class="user-avatar" onclick="toggleUserDropdown()">
                    <span class="material-icons">person</span>
                </div>
                <div class="user-dropdown" id="userDropdown">
                    <div class="dropdown-header">Switch View</div>
                    <div class="dropdown-item active" onclick="switchView('recommender')">
                        <span class="material-icons">edit</span>
                        <div class="view-label">
                            <div class="view-name">Recommender</div>
                            <div class="view-description">Write & send letters</div>
                        </div>
                    </div>
                    <div class="dropdown-item" onclick="switchView('student')">
                        <span class="material-icons">school</span>
                        <div class="view-label">
                            <div class="view-name">Student</div>
                            <div class="view-description">Track applications</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <h1 class="hero-title">One Upload. Multiple Universities.</h1>
            <p class="hero-subtitle">Upload your recommendation letter once and send it to multiple US universities
                instantly.</p>
        </div>

        <!-- Upload Section -->
        <div class="upload-section" id="uploadSection">
            <div class="upload-area">
                <div class="upload-icon">
                    <span class="material-icons">cloud_upload</span>
                </div>
                <h2 class="upload-title">Upload Recommendation Letter</h2>
                <p class="upload-subtitle">Drag and drop your PDF file here, or click to browse</p>
                <input type="file" id="fileInput" class="file-input" accept=".pdf" />
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    <span class="material-icons">upload_file</span>
                    Choose File
                </button>
            </div>

            <div class="uploaded-file" id="uploadedFile">
                <div class="file-info">
                    <div class="file-icon">
                        <span class="material-icons">description</span>
                    </div>
                    <div class="file-details">
                        <h3 id="fileName">recommendation-letter.pdf</h3>
                        <p id="fileSize">2.4 MB • Uploaded successfully</p>
                    </div>
                    <button class="remove-file" onclick="removeFile()">
                        <span class="material-icons">close</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- University Selection -->
        <div class="university-section">
            <h2 class="section-title">
                <span class="material-icons">school</span>
                Select Universities
            </h2>

            <div class="university-search">
                <input type="text" class="search-input" placeholder="Search universities..." id="universitySearch" />
            </div>

            <div class="university-grid" id="universityGrid">
                <!-- Universities will be populated here -->
            </div>
        </div>

        <!-- Selected Universities -->
        <div class="selected-section">
            <h2 class="section-title">
                <span class="material-icons">check_circle</span>
                Selected Universities
            </h2>
            <div class="selected-count" id="selectedCount">0 universities selected</div>
            <div class="selected-list" id="selectedList">
                <!-- Selected universities will appear here -->
            </div>

            <div class="send-section">
                <button class="send-btn" id="sendBtn" disabled onclick="sendLetters()">
                    <span class="material-icons">send</span>
                    Send to Selected Universities
                </button>
            </div>
        </div>

        <!-- Progress Section -->
        <div class="progress-section" id="progressSection">
            <h2 class="progress-title">Sending Letters...</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Preparing to send...</div>

            <div class="delivery-list" id="deliveryList">
                <!-- Delivery status will appear here -->
            </div>
        </div>

        <!-- Success Section -->
        <div class="success-section" id="successSection">
            <div class="success-icon">
                <span class="material-icons">check_circle</span>
            </div>
            <h2 class="success-title">Letters Sent Successfully!</h2>
            <p class="success-subtitle">Your recommendation letter has been delivered to all selected universities.</p>
            <button class="new-upload-btn" onclick="startNewUpload()">
                <span class="material-icons">add</span>
                Send Another Letter
            </button>
        </div>
    </div>

    <script>
        // Sample university data
        const universities = [
            { id: 1, name: "Harvard University", location: "Cambridge, MA", logo: "H" },
            { id: 2, name: "Stanford University", location: "Stanford, CA", logo: "S" },
            { id: 3, name: "MIT", location: "Cambridge, MA", logo: "MIT" },
            { id: 4, name: "Yale University", location: "New Haven, CT", logo: "Y" },
            { id: 5, name: "Princeton University", location: "Princeton, NJ", logo: "P" },
            { id: 6, name: "Columbia University", location: "New York, NY", logo: "C" },
            { id: 7, name: "University of Chicago", location: "Chicago, IL", logo: "UC" },
            { id: 8, name: "University of Pennsylvania", location: "Philadelphia, PA", logo: "UP" },
            { id: 9, name: "California Institute of Technology", location: "Pasadena, CA", logo: "CIT" },
            { id: 10, name: "Johns Hopkins University", location: "Baltimore, MD", logo: "JH" },
            { id: 11, name: "Northwestern University", location: "Evanston, IL", logo: "NU" },
            { id: 12, name: "Duke University", location: "Durham, NC", logo: "D" },
            { id: 13, name: "Dartmouth College", location: "Hanover, NH", logo: "DC" },
            { id: 14, name: "Brown University", location: "Providence, RI", logo: "B" },
            { id: 15, name: "Vanderbilt University", location: "Nashville, TN", logo: "V" },
            { id: 16, name: "Rice University", location: "Houston, TX", logo: "R" },
            { id: 17, name: "Washington University in St. Louis", location: "St. Louis, MO", logo: "WU" },
            { id: 18, name: "Cornell University", location: "Ithaca, NY", logo: "CU" },
            { id: 19, name: "University of Notre Dame", location: "Notre Dame, IN", logo: "ND" },
            { id: 20, name: "UCLA", location: "Los Angeles, CA", logo: "UCLA" }
        ];

        let selectedUniversities = [];
        let uploadedFile = null;
        let currentView = 'recommender';

        // Initialize
        document.addEventListener('DOMContentLoaded', function () {
            renderUniversities(universities);
            setupFileUpload();
            setupSearch();
            setupClickOutside();
        });

        // User dropdown functionality
        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }

        function switchView(view) {
            currentView = view;

            // Update active state in dropdown
            document.querySelectorAll('.dropdown-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.dropdown-item').classList.add('active');

            // Update dashboard content based on view
            updateDashboardForView(view);

            // Close dropdown
            document.getElementById('userDropdown').classList.remove('show');
        }

        function updateDashboardForView(view) {
            const heroTitle = document.querySelector('.hero-title');
            const heroSubtitle = document.querySelector('.hero-subtitle');
            const uploadTitle = document.querySelector('.upload-title');

            if (view === 'student') {
                heroTitle.textContent = 'Track Your Applications';
                heroSubtitle.textContent = 'Monitor the status of your recommendation letters and university applications.';
                uploadTitle.textContent = 'Request Recommendation Letter';

                // Could add student-specific functionality here
                // For now, we'll keep the same interface but with different messaging
            } else {
                heroTitle.textContent = 'One Upload. Multiple Universities.';
                heroSubtitle.textContent = 'Upload your recommendation letter once and send it to multiple US universities instantly.';
                uploadTitle.textContent = 'Upload Recommendation Letter';
            }
        }

        function setupClickOutside() {
            document.addEventListener('click', function (event) {
                const userInfo = document.querySelector('.user-info');
                const dropdown = document.getElementById('userDropdown');

                if (!userInfo.contains(event.target)) {
                    dropdown.classList.remove('show');
                }
            });
        }

        // File upload functionality
        function setupFileUpload() {
            const fileInput = document.getElementById('fileInput');
            const uploadSection = document.getElementById('uploadSection');

            fileInput.addEventListener('change', handleFileUpload);

            // Drag and drop
            uploadSection.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadSection.classList.add('dragover');
            });

            uploadSection.addEventListener('dragleave', () => {
                uploadSection.classList.remove('dragover');
            });

            uploadSection.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadSection.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });
        }

        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            if (file.type !== 'application/pdf') {
                alert('Please upload a PDF file.');
                return;
            }

            uploadedFile = file;
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = `${(file.size / 1024 / 1024).toFixed(1)} MB • Uploaded successfully`;
            document.getElementById('uploadedFile').style.display = 'block';

            updateSendButton();
        }

        function removeFile() {
            uploadedFile = null;
            document.getElementById('uploadedFile').style.display = 'none';
            document.getElementById('fileInput').value = '';
            updateSendButton();
        }

        // University search and selection
        function setupSearch() {
            const searchInput = document.getElementById('universitySearch');
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const filtered = universities.filter(uni =>
                    uni.name.toLowerCase().includes(query) ||
                    uni.location.toLowerCase().includes(query)
                );
                renderUniversities(filtered);
            });
        }

        function renderUniversities(universitiesToRender) {
            const grid = document.getElementById('universityGrid');
            grid.innerHTML = universitiesToRender.map(uni => `
                <div class="university-card ${selectedUniversities.includes(uni.id) ? 'selected' : ''}" 
                     onclick="toggleUniversity(${uni.id})">
                    <div class="university-header">
                        <div class="university-logo">${uni.logo}</div>
                        <div>
                            <div class="university-name">${uni.name}</div>
                            <div class="university-location">${uni.location}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleUniversity(id) {
            if (selectedUniversities.includes(id)) {
                selectedUniversities = selectedUniversities.filter(uId => uId !== id);
            } else {
                selectedUniversities.push(id);
            }

            renderUniversities(universities);
            updateSelectedList();
            updateSendButton();
        }

        function updateSelectedList() {
            const selectedList = document.getElementById('selectedList');
            const selectedCount = document.getElementById('selectedCount');

            selectedCount.textContent = `${selectedUniversities.length} universities selected`;

            selectedList.innerHTML = selectedUniversities.map(id => {
                const uni = universities.find(u => u.id === id);
                return `
                    <div class="selected-tag">
                        ${uni.name}
                        <div class="remove-tag" onclick="toggleUniversity(${id})">×</div>
                    </div>
                `;
            }).join('');
        }

        function updateSendButton() {
            const sendBtn = document.getElementById('sendBtn');
            const canSend = uploadedFile && selectedUniversities.length > 0;
            sendBtn.disabled = !canSend;
        }

        // Send letters functionality
        function sendLetters() {
            if (!uploadedFile || selectedUniversities.length === 0) return;

            // Hide other sections and show progress
            document.getElementById('progressSection').style.display = 'block';
            document.querySelector('.upload-section').style.display = 'none';
            document.querySelector('.university-section').style.display = 'none';
            document.querySelector('.selected-section').style.display = 'none';

            simulateDelivery();
        }

        function simulateDelivery() {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const deliveryList = document.getElementById('deliveryList');

            let progress = 0;
            let currentUniversity = 0;

            const interval = setInterval(() => {
                progress += 100 / selectedUniversities.length;
                progressFill.style.width = `${Math.min(progress, 100)}%`;

                if (currentUniversity < selectedUniversities.length) {
                    const uni = universities.find(u => u.id === selectedUniversities[currentUniversity]);

                    // Add delivery item
                    const deliveryItem = document.createElement('div');
                    deliveryItem.className = 'delivery-item';
                    deliveryItem.innerHTML = `
                        <div class="delivery-status pending">⏳</div>
                        <div>${uni.name}</div>
                        <div style="margin-left: auto; color: #ff9800;">Sending...</div>
                    `;
                    deliveryList.appendChild(deliveryItem);

                    // Update to success after a moment
                    setTimeout(() => {
                        deliveryItem.innerHTML = `
                            <div class="delivery-status success">✓</div>
                            <div>${uni.name}</div>
                            <div style="margin-left: auto; color: #4caf50;">Delivered</div>
                        `;
                    }, 500);

                    currentUniversity++;
                    progressText.textContent = `Sending to ${uni.name}...`;
                }

                if (progress >= 100) {
                    clearInterval(interval);
                    progressText.textContent = 'All letters sent successfully!';

                    setTimeout(() => {
                        document.getElementById('progressSection').style.display = 'none';
                        document.getElementById('successSection').style.display = 'block';
                    }, 1000);
                }
            }, 1000);
        }

        function startNewUpload() {
            // Reset everything
            uploadedFile = null;
            selectedUniversities = [];

            document.getElementById('successSection').style.display = 'none';
            document.querySelector('.upload-section').style.display = 'block';
            document.querySelector('.university-section').style.display = 'block';
            document.querySelector('.selected-section').style.display = 'block';

            removeFile();
            updateSelectedList();
            updateSendButton();

            // Clear progress section
            document.getElementById('deliveryList').innerHTML = '';
            document.getElementById('progressFill').style.width = '0%';
        }
    </script>
</body>

</html>